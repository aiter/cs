### 虚拟地址空间
1. 内核空间(内核态可以访问)
2. 用户空间(用户态访问，不能访问内核空间内存)

```
0xFFFFFFFF+----------------+   +----------------+0xFFFFFFFFFFFFFFFF
          | 内核空间 1G    |   | 内核空间 128T  |
0xC0000000+----------------+   +----------------+0xFFFF800000000000
          |                |   |                |
          |                |   | 未定义         |
          |                |   |                |
          |                |   |                |
          |                |   +----------------+0x00007FFFFFFFF000 
          | 用户空间 3G    |   | 用户空间 128T  |
0x00000000+----------------+   +----------------+0x0000000000000000
             32位                   128位
```

* 只读段：代码和常量
* 数据段：全局变量等
* 堆：动态分配的内存，从低地址开始增长
* 文件映射：动态库，共享内存等，从高地址开始向下增长
* 栈，局部变量和函数调用的上下文。
```
0xFFFFFFFF+----------------+  
          | 内核空间       |  
0xC0000000+----------------+  
          |  栈            |  
          +----------------+  
          | 文件映射       |  
          |                |
          +----------------+  
          | 堆             |  
          |                |
          +----------------+  
          | 数据段         |  
          +----------------+  
          | 只读段         |  
0x00000000+----------------+  
             32位             
```

### 内存分配
malloc()
 * brk() 小内存，在堆中分配
 * mmap() 大内存，在文件映射中分配

### 工具
* bcc工具包
* cachestat
* cachetop
* pcstat

